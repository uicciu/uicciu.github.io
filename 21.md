
# (2+1) SIMPLE CNN CRYPTANALYTIC EXTRACTION PROJECT

## Project Overview
This project demonstrates the complete process of successfully recovering the weights of a two-layer (2+1) CNN model trained on MNIST dataset under the **black-box scenario**.

## Brief Description of Key Files
1. **common.py**:Provides basic configurations and model definitions, and stores model information for accuracy testing.
2. **extract_signature_cuda.py**: Extracts the signatures of the CNN's **two convolutional layers** with GPU acceleration, processes the difference vectors collected from Pooling Switch Points (PSP) via Singular Value Decomposition (SVD), solves homogeneous linear equations, and extracts the weights of the two convolutional layers.
3. **reconstructCNN.py**: Contains modules for model parameter reconstruction and error analysis. It recovers the complete weight matrix of convolutional kernels using the extracted vectors and compares the precision with the ground truth values.
4. **recover_sign.py**: Adopts the ReLU-Pooling Critical Point (RPCP) method and leverages the characteristics of max-pooling layers to recover the signs of weights.
5. **find_witnesses.py**:Finds the critical points that meet the specified requirements.

## Workflow Pipeline

### STEP1:Generate the CNN Model

```bash
python create_CNN.py
```
改变参数生成属于你的CNN模型，也可以直接使用我们已经生成的模型(e.g.,simple_cnn_2+1.pth)

Meanwhile, import your newly generated model into common.py.

### STEP2:Directly Extract CNN Model Weights and Verify Precision

```bash
python AttackCNN.py
```
This command completes the full process including weight extraction, precision improvement, weight sign recovery and precision detection, and outputs the complete experimental data.

---

